<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Repairo â€” OTP Auth</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>
<style>
.fade { animation: fadeIn .35s ease-out; }
@keyframes fadeIn { from {opacity:0} to {opacity:1} }
@keyframes slowRotate { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
</style>
</head>
<body class="relative min-h-screen bg-slate-100 dark:bg-slate-900 transition-all duration-300">
<div class="min-h-screen flex flex-col justify-center items-center px-4">

  <div class="mb-6 text-center">
    <img src="repairologo.png" class="w-24 h-24 mx-auto">
  </div>

  <div class="w-full max-w-md bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-xl fade">

    <h2 id="title" class="text-2xl font-bold text-teal-600 dark:text-teal-400 mb-4 text-center">Login with OTP</h2>

    <div id="nameBox" class="hidden">
      <label class="text-sm text-gray-500 dark:text-gray-300">Full Name</label>
      <input id="name" class="w-full p-2 mt-1 mb-3 rounded-lg border dark:bg-slate-700 dark:border-slate-600" placeholder="Your Name">
    </div>

    <label class="text-sm text-gray-500 dark:text-gray-300">Phone (+91)</label>
    <input id="phone" class="w-full p-2 mt-1 rounded-lg border dark:bg-slate-700 dark:border-slate-600" placeholder="+91 9876543210">
    <input id="otp" class="w-full p-2 rounded-lg border mt-4 dark:bg-slate-700 dark:border-slate-600" placeholder="Enter 6-digit OTP">

    <button id="sendOtpBtn" class="w-full bg-teal-600 text-white p-2 rounded-lg mt-4">Send OTP</button>
    <button id="verifyOtpBtn" class="w-full bg-teal-700 text-white p-2 rounded-lg mt-3">Verify OTP</button>
    <p id="msg" class="text-center mt-3 text-sm"></p>

  </div>
</div>

<script>
const phoneInput = document.getElementById("phone");
const otpInput = document.getElementById("otp");
const msg = document.getElementById("msg");
const sendBtn = document.getElementById("sendOtpBtn");
const verifyBtn = document.getElementById("verifyOtpBtn");

function show(m, color="red") { msg.innerText = m; msg.style.color = color; }

sendBtn.onclick = async () => {
  const phone = phoneInput.value.trim();
  if (!phone.startsWith("+")) return show("Use full number with country code");
  try {
    const res = await fetch("https://repairo-3.onrender.com/send-otp", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ phone })
    });
    const data = await res.json();
    if (data.success) show("OTP sent!", "green");
    else show("Failed to send OTP");
  } catch(err) { show("Error: "+err.message); }
};

verifyBtn.onclick = async () => {
  const phone = phoneInput.value.trim();
  const otp = otpInput.value.trim();
  try {
    const res = await fetch("https://repairo-3.onrender.com/verify-otp", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ phone, otp })
    });
    const data = await res.json();
    if (data.success) show("OTP verified! Redirecting...", "green");
    else show("Invalid OTP");
  } catch(err) { show("Error: "+err.message); }
};
</script>
</body>
</html>
